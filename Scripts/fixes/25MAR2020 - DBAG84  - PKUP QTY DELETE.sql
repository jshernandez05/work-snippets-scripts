###################################################
#  -- STEP 1 -- QUERY INVENTORY QUANTITIES        #
###################################################

select niin, depl_pkup_qty
from ds02_invdata
where niin in (
'015756729', 
'015765006', 
'015756741', 
'015755005', 
'015757768', 
'015756743', 
'151196968', 
'011909330', 
'011943909', 
'012044542', 
'011933597', 
'010699571', 
'011704024', 
'011704057', 
'012053793', 
'011594079', 
'012119032', 
'010924391', 
'015017373', 
'011002391', 
'012129104', 
'012119050', 
'011909331', 
'012057417', 
'011857633', 
'011881619', 
'151196995', 
'012025372', 
'014633145', 
'014206593', 
'010729878', 
'012777158', 
'151197017', 
'151196999', 
'011910084', 
'012057086', 
'151196996', 
'012106137', 
'011933589', 
'012221993', 
'012053794', 
'014137580', 
'013926971', 
'011002292', 
'011986372', 
'013869830', 
'013908846', 
'013908852', 
'012129103', 
'014910203', 
'014910189'
)
go


###################################################
#  -- STEP 2 -- QUERY PACK UP ITEMS FROM DS03     #
###################################################

select * from ds03_item
where bal_cd like 'PK'
and (pkup_id like 'MACS4A' or pkup_id like 'WEATHR')
and niin in (
'015756729', 
'015765006', 
'015756741', 
'015755005', 
'015757768', 
'015756743', 
'151196968', 
'011909330', 
'011943909', 
'012044542', 
'011933597', 
'010699571', 
'011704024', 
'011704057', 
'012053793', 
'011594079', 
'012119032', 
'010924391', 
'015017373', 
'011002391', 
'012129104', 
'012119050', 
'011909331', 
'012057417', 
'011857633', 
'011881619', 
'151196995', 
'012025372', 
'014633145', 
'014206593', 
'010729878', 
'012777158', 
'151197017', 
'151196999', 
'011910084', 
'012057086', 
'151196996', 
'012106137', 
'011933589', 
'012221993', 
'012053794', 
'014137580', 
'013926971', 
'011002292', 
'011986372', 
'013869830', 
'013908846', 
'013908852', 
'012129103', 
'014910203', 
'014910189'
)
go

###################################################
#  -- STEP 3 -- DELETE PACK UP ITEMS FROM DS03    #
###################################################

-- delete from ds03_item
where bal_cd like 'PK'
and (pkup_id like 'MACS4A' or pkup_id like 'WEATHR')
and niin in (
'015756729', 
'015765006', 
'015756741', 
'015755005', 
'015757768', 
'015756743', 
'151196968', 
'011909330', 
'011943909', 
'012044542', 
'011933597', 
'010699571', 
'011704024', 
'011704057', 
'012053793', 
'011594079', 
'012119032', 
'010924391', 
'015017373', 
'011002391', 
'012129104', 
'012119050', 
'011909331', 
'012057417', 
'011857633', 
'011881619', 
'151196995', 
'012025372', 
'014633145', 
'014206593', 
'010729878', 
'012777158', 
'151197017', 
'151196999', 
'011910084', 
'012057086', 
'151196996', 
'012106137', 
'011933589', 
'012221993', 
'012053794', 
'014137580', 
'013926971', 
'011002292', 
'011986372', 
'013869830', 
'013908846', 
'013908852', 
'012129103', 
'014910203', 
'014910189'
)
go

#####################################################
#  -- STEP 4 -- UPDATE DS02 COUNTERS TO MATCH DS03  #
#####################################################


-- update ds02_invdata set
depl_pkup_qty = (select sum(itm_qty) from ds03_item where niin in (									'015756729', 
				'015765006', 
				'015756741', 
				'015755005', 
				'015757768', 
				'015756743', 
				'151196968', 
				'011909330', 
				'011943909', 
				'012044542', 
				'011933597', 
				'010699571', 
				'011704024', 
				'011704057', 
				'012053793', 
				'011594079', 
				'012119032', 
				'010924391', 
				'015017373', 
				'011002391', 
				'012129104', 
				'012119050', 
				'011909331', 
				'012057417', 
				'011857633', 
				'011881619', 
				'151196995', 
				'012025372', 
				'014633145', 
				'014206593', 
				'010729878', 
				'012777158', 
				'151197017', 
				'151196999', 
				'011910084', 
				'012057086', 
				'151196996', 
				'012106137', 
				'011933589', 
				'012221993', 
				'012053794', 
				'014137580', 
				'013926971', 
				'011002292', 
				'011986372', 
				'013869830', 
				'013908846', 
				'013908852', 
				'012129103', 
				'014910203', 
				'014910189'
																)
				)
where niin in (
				'015756729', 
				'015765006', 
				'015756741', 
				'015755005', 
				'015757768', 
				'015756743', 
				'151196968', 
				'011909330', 
				'011943909', 
				'012044542', 
				'011933597', 
				'010699571', 
				'011704024', 
				'011704057', 
				'012053793', 
				'011594079', 
				'012119032', 
				'010924391', 
				'015017373', 
				'011002391', 
				'012129104', 
				'012119050', 
				'011909331', 
				'012057417', 
				'011857633', 
				'011881619', 
				'151196995', 
				'012025372', 
				'014633145', 
				'014206593', 
				'010729878', 
				'012777158', 
				'151197017', 
				'151196999', 
				'011910084', 
				'012057086', 
				'151196996', 
				'012106137', 
				'011933589', 
				'012221993', 
				'012053794', 
				'014137580', 
				'013926971', 
				'011002292', 
				'011986372', 
				'013869830', 
				'013908846', 
				'013908852', 
				'012129103', 
				'014910203', 
				'014910189'
				)
go


#####################################################
#  -- STEP 5 -- VALIDATE CHANGES                    #
#####################################################
/*	RUN QUERIES FROM STEP 1 AND STEP 2 TO ENSURE
	CHANGES HAVE BEEN MADE
*/
	